---

- name: Create scheduled watchtower app container
  docker_container:
    name: watchtower-app
    image: containrrr/watchtower
    hostname: "{{ ansible_hostname }}"
    pull: true
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    env: "{{ watchtower_environment_variables }}"
    command: --monitor-only --schedule "{{ watchtower_schedule }}"
    restart_policy: unless-stopped
    container_default_behavior: compatibility
